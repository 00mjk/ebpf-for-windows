environment:
  host:
    os: 'windows'
    flavor: 'server'
    version: '2019'
  runtime:
    provider: 'appcontainer'
    image: 'cdpxwinrs5.azurecr.io/global/vse2019/16.3.7:latest'
    source_mode: map

restore:
  commands:
    - !!defaultcommand
      name: 'Restore Node'
      command: 'src\WindowsServerSample\Node\restore.cmd'
    - !!defaultcommand
      name: 'Restore Node'
      command: 'src\WindowsServerSample\AzureDevOpsExtension\restore.cmd'

build:
  commands:
    - !!buildcommand
      name: 'Build Node'
      fail_on_stderr: false
      command: 'src\WindowsServerSample\Node\officialBuild.cmd'
      artifacts:
        - from: 'src\WindowsServerSample\Node\oe-template'
          to: 'Node'
          include:
            - 'build/'
          signing_options:
            sign_inline: true
    - !!buildcommand
      name: 'Build Node'
      fail_on_stderr: false
      command: 'src\WindowsServerSample\AzureDevOpsExtension\build.cmd'
      artifacts:
        - from: 'src\WindowsServerSample\AzureDevOpsExtension\'
          to: 'AzureDevOpsExtension'
          include:
            - '**/*.vsix'
          signing_options:
            sign_inline: true
test:
  commands: